#summary This is to explain in detail how to make shaders.
#labels Phase-Implementation

This is WIP until it's finished. This was all grabbed from Volshebnyi from the forum thread.

What is a shader?!
A Shader is a small program, which affects every vertex and pixel of object. There are two parts of shader: vertex shader (this one can transform any surface, for example, it can make neck wavy) and pixel (fragment) shader (it can change color of every pixel on the screen). Vertex shader + pixel shader = shader program.

==How to create shader==
There are many shader languages. The only true is GLSL. It's C-like and easy to use language. You must compile shader before you can use it in program. Let's make a simple shader program.
1) Go to FoFiX\Data\Shaders\ and create two files: "myshader.ps" and "myshader.vs"

2) Open "myshader.vs" with notepad. Here's a code:
{{{
void main()
{
  gl_Position = ftransform();
  gl_Position.z = gl_Position.z - 0.01; //It's very-very important string!
}
}}}
It'll be our vertex shader. What is it doing? Nothing! =) It just transforms object like OpenGL standart program.
Oh, it also moves object a little bit nearer.

3) Open "myshader.ps" with notepad. Here's a code:
{{{
void main()
{
  gl_FragColor = vec4(1.0,0.0,1.0,0.5);   
}
}}}
It our fragment shader. It makes all pixel of our object violet and half transparent. Cool? No! But let's try!

4) Shader program is ready for action! Let's use it in FoFiX. Where? CD songlist is the best option! Open src\Dialogs.py. Search "Shader.list." That's it:
{{{
if Shader.list.enable("cd"):
      self.cassette.render("Mesh_001")
      Shader.list.disable()
}}}
Delete these lines, we'll replace them with our new shader.

5) Still "Dialogs.py", line 1608. We need to enable our shader program.
{{{
Shader.list.enable("myshader")
}}}
That's it! Our shader is enabled! What about compilation? You don't need to compile, because shader module already compiled it and put it to Shader.list.
6) Let's draw a CDs and disable shader.
{{{
Shader.list.enable("myshader")
self.cassette.render("Mesh_001") #render CD
Shader.list.disable() # don't forget to disable shader!
}}}
7) Shader.list.enable() return False if shader activation failed, So we don't need to perform following actions if **** happened.
{{{
if Shader.list.enable("myshader"):
  self.cassette.render("Mesh_001") #render CD
#You may place here other objects
  Shader.list.disable() # don't forget to disable shader!
}}}
8) Done! Compile FoFiX. What shall we see in CD songlist? Violet CDs.

==SST. Part II: Variables==

1) Edit your vertex shader code:
{{{
uniform float time;
void main()
{
  gl_Position = ftransform(); // don't forget about semicolons. It's not a Python!
  gl_Position.z -= 0.01; //It's very-very important string!
}
}}}
We declared our first variable! Now we need to use it:
{{{
uniform float time;
void main()
{
  gl_Position = ftransform();
  gl_Position.z -= 0.01; //It's very-very important string!
  gl_Position.x += sin(time); //CD dance
}
}}}
2) Good. Now we need to set this variable. "Dialogs.py", line 1608
{{{
if Shader.list.enable("myshader"):
      Shader.list.setVar("time",self.time)
      self.cassette.render("Mesh_001")
      Shader.list.disable()
}}}
setVar function sets active shader's variable "name" value. If your shader is not active, you may do this:
{{{
Shader.list.setVar("time",self.time,program="myshader")
    if Shader.list.enable("myshader"):
      Shader.list.update()
      self.cassette.render("Mesh_001")
      Shader.list.disable()
}}}
Shader.list.update() updates all variables in shader. But previous code is much better:
{{{
if Shader.list.enable("myshader"):
      Shader.list.setVar("time",self.time)
      self.cassette.render("Mesh_001")
      Shader.list.disable()
}}}
3) Done! Now about varying type. Vertex shader's Varying variables can be used by pixel shader. A small example. Edit myshader.vs:
{{{
uniform float time;
varying float alpha;
void main()
{
  gl_Position = ftransform();
  gl_Position.z -= 0.01; //It's very-very important string!
  gl_Position.x += sin(time); //CD dance
  alpha = abs(sin(time/10));
}
}}}
myshader.ps:
{{{
varying float alpha;
void main()
{
  gl_FragColor = vec4(1.0,0.0,1.0,alpha);   
}
}}}
4) Now CDs will blink.

==Vectors, Colors==

Vector types are like list type in python.  There are 9 of them: 
vec2,vec3,vec4 (n-dimensional float vector), 
ivec2,ivec3,ivec4, (integer)
bvec2, bvec3, bvec4, (boolean)
{{{
vec3 myvect; // don't forget!
myvect = vec3(1.0,2.0,3.0); // myvect = (1.0,2.0,3.0); - wrong!!!
myvect.x = 1.5; // myvect = vec3(1.5,2.0,3.0);
myvect.xz = myvect.zy; // myvect = vec3(3.0,2.0,2.0);
vec4 newvect = vec4(myvect.xy*2, 0.0, myvect.x); // vec4 newvect = vec4(6.0,4.0,0.0,3.0);
gl_Position = newvect; // only for vertex shader!
}}}

How to use your vector in shader.
In shader program (myshader.vs):
{{{
uniform vec3 vect1;
uniform ivec4 vect2;
}}}
In python script:
{{{
Shader.list.setVar("vect1",(0.1,0.2,0.3),"myshader")
#if shader is enabled:
#Shader.list.setVar("vect1",(0.1,0.2,0.3))
Shader.list.setVar("vect2",(4,3,2,1),"myshader")
print Shader.list.getVar("vect1","myshader")
}}}

Color is vec4:
{{{
vec4 color = vec4(0.8,0.5,0.3,1.0); // red,green,blue,alpha
vec2 myvec = color.br; // vec2 myvec = (0.3,0.8);
color.a = (color.r+color.g+color.b)/3.0;
gl_FragColor = color; //only for fragment shader!
}}}

Uniform usage.

In shader program (myshader.vs):
{{{
uniform vec4 color;
}}}

In python script:
{{{
Shader.list.setVar("vect1",(1.0,1.0,0.0,1.0),"myshader") #yellow
}}}

==Textures==

== Shader Development Environment ==
You can use a GLSL IDE to create your shader files and preview the effects.

  * [http://lumina.sourceforge.net Lumina], a free crossplatform development environment for GLSL shaders.
  * [http://developer.amd.com/gpu/rendermonkey/Pages/default.aspx RenderMonkey], rich shader development environment (you can import shaders from it).